The first cell is my original code, it was made to compare pitch angles of precipitating electrons, at two different altitudes. It includes two different functions. One is for a simple dipole model equation to calculate the magnetic field at a specific altitude, and the other to calculate the pitch angle based on a known angle and the field values at the two altitudes. For the magnetic field equation you input an altitude in kilometers, and it will give you a value in nanoTesla. For the second function you input an angle in degrees, and the field values at both altitudes, and it will output an angle in degrees. For info on the equations used, see my presentation located on AWB.   

For each cell afterwards it creates a graph showing a distribution of modified pitch angles based on different magnetic field models. They are each compared to a "known" pitch angle 0-90 degrees at 840km, representing a potential angle from the same altitude as the DMSP satellites. The first magnetic field model I used was the simple magnetic dipole equation in the first function of the program. The next takes values taken from a research paper on modelling Earth's magnetic field provided by Dr. Laura Peticolas. After are values from NOAA -National Oceanic and Atmospheric Administration- based on the WMM - World Magnetic Model. I input a geographic latitude of 78.5 degrees (representing the equatorial boundary of the polar cusp, at 77.5 degrees MLAT) and a date of December 2024 (the latest possible date), used a range of longitudes, and took values for both 500km and 840km altitude. If we choose to use pitch angle data from a satellite at 840km but a different latitude, the field values would need to be recollected, but this may be done with relative ease. For the WMM I only used about 10 longitude values and took an average, leading to a less precise output. After some brief research I also learned the WMM has limitations in accuracy as you near the polar cusp region. Thus, for the last graph I decided to use the IGRF -International Geomagnetic Reference Field- for the same month and year. I recorded values for every 5 degrees and took averages. For each cell it creates an array of angles 0-90 degrees, then uses the known angle and field values for the model in use to create another array of solved angles. The field values are constants in the Each graph uses the same steps to calculate and graph the results. The x-axis is always the known angle, and the y-axis is the calculated angle. The graphs are titled based on the magnetic model in use. 

This code is useful to compare the pitch angle from a certain altitude and field value to the altitude that our satellite is going to be at. The code can more specifically be used by calling the Calc_pitch_angle function with a known pitch angle, the field value at 500km for our satellite, and a field value based on the altitude of the known pitch angle.

You can use this code to model the pitch angle distribution for any field model if you enter the values for 500km and 840km as constants, and create a cell the same as any of the ones containing the graphs, passing the values as B1 and B2 respectively.

Referencing my presentation can provide more context to the equations used, and each unique function and step for the calculation is commented within the file